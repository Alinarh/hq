<ul class="breadcrumb">
  <li><a href='/study/group'>Успеваемость</a></li>
  <li><a href="<%= study_group_progress_path(params[:group_id]) %>">Группа</a></li>
  <li class="active">Студент</li>
</ul>
<div class="page-header">
  <h1><%= @student.person.full_name %> <small><%= @student.group.name %></small></h1>
  <h2>Успеваемость</h2>
</div>
<div class='alert alert-info'>Нажмите на название дисциплины, чтобы посмотреть подробную информацию по ней.</div>
<table class='table table-bordered table-condensed'>
  <thead>
    <tr>
      <th>Дата</th>
      <% @student.disciplines.each do |d| %>
        <th><a href="/study/group/<%= params[:group_id] %>/student/<%= @student.id %>/discipline/<%= d.id %>"><%= d.name %></a></th>
      <% end %>
    </tr>
  </thead>
  <tbody>
    <% @rows.each do |row| %>
    <tr>
      <td><%= row[0].strftime("%d.%m.%Y") %></td>
      <% row.shift %>
        <% row.each do |marks|%>
      <td>
        <% marks.shift %>
        <% marks.each do |mark| %>
           <% if mark[:checkpoint].checkpoint_type == 3 %>
             <div data-toggle='tooltip' title data-original-title="<%= mark[:checkpoint].name %> / <%=  mark[:mark] != nil ? ( mark[:mark].mark>=mark[:checkpoint].min ? 'прошёл контрольную точку' : 'не прошёл контрольную точку') : 'нет данных' %>" style="border-radius: 50%;
                 background-color: <%= mark[:mark] != nil ?  ( mark[:mark].mark>=mark[:checkpoint].min ? '#62c462' : '#ee5f5b') : '#fff' %>;
                 width: 30px; height: 30px;
                 border: 1px solid black;
                 margin-right: 10px;
                 padding: 4px 0 0 <%= (mark[:mark].mark < 10 ? 10 : 6) if mark[:mark] != nil %>px;
                 margin-top: 5px;"
                 class='pull-left control'><strong><%= mark[:mark].mark if mark[:mark] != nil %></strong></div>
           <% else %>
             <% if mark[:mark] == nil %>
              <div data-toggle='tooltip' title data-original-title="<%= mark[:checkpoint].checkpoint_type == 1 ? 'Лекция' : 'Практическое (лабораторное) занятие' %> / нет данных"
                  style="border-radius: 50%;
                  background-color: #fff;
                  width: <%= mark[:checkpoint].checkpoint_type == 1 ? '10' : '20' %>px; height: <%= mark[:checkpoint].checkpoint_type == 1 ? '10' : '20' %>px;
                  border: 1px solid black;
                  margin-right: 10px;
                  margin-top: 5px;"
                   class='pull-left lesson'></div>
             <% else %>
             <div data-toggle='tooltip' title data-original-title="<%= mark[:checkpoint].checkpoint_type == 1 ? 'Лекция' : 'Практическое (лабораторное) занятие' %> / <%= mark[:mark].result[:mark] %>"
                  style="border-radius: 50%;
             background-color: <%= mark[:mark].result[:hue] %>;
             width: <%= mark[:mark].result[:circle] %>px; height: <%= mark[:mark].result[:circle] %>px;
             border: 1px solid black;
             margin-right: 10px;
             margin-top: 5px;"
             class='pull-left lesson'></div>
             <% end %>
           <% end %>
        <% end %>
      </td>
    <% end %>
    </tr>
    <% end %>
  </tbody>
</table>
<a class="btn btn-default" href="/study/group/<%= params[:group_id] %>/progress"><span class='glyphicon glyphicon-backward'></span> Назад к группе</a>